<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Pre Condition</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <style>
        body{
            margin: 0;
            background-color: black;
            color: white;
        }
        #start_scene1{
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
            padding: 10px 20px;
            z-index: 100;
            font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            cursor: pointer;
        }
    </style>
</head>
<body>  


    <div id="intro_page" style="display: block;">
        <button id="start_scene1">Click</button>
    </div>

    <a-scene cursor="rayOrigin: mouse" visible="false" rotation="">
    
    <!-- scene1 -->
    <a-entity id="scene1" visible="false" light="defaultLightsEnabled: false">
        
        <a-plane id="object_plane" class="ray-target" width="2" height="3" position="-11 0.5 -6" rotation="0 80 0" color="green" material="opacity: 0.4; shader: flat; transparent: true"> </a-plane>
        <a-plane id="object_dummy_plane" class="ray-target" width="2" height="3" position="-11 0.5 5" rotation="0 120 0" color="red" material="opacity: 0.4; shader: flat; transparent: true"> </a-plane>
       
        <!--Object Text -->
        <a-text id="object1_text" 
            value="Object text " 
            position="-5 2 -3" 
            align="center" 
            rotation="0 90 0"
            color="yellow">
        </a-text>

        <!--Object Dummy Text -->
        <a-text id="object1_dummy_text" 
            value="Object text " 
            position="-5 2 2.5" 
            align="center" 
            rotation="0 90 0"
            color="yellow">
        </a-text>
    
    </a-entity>

    <!-- sky sphere - FIXED -->
    <a-sphere 
        id="sky"
        radius="50"
        material="side: back; src: ./images/check2.jpg; shader: flat; repeat: -1 1"
        rotation="0 180 0"
        position="0 0 0">
    </a-sphere>


    <!-- camera rig -->
    <a-entity id="rig" rotation="0 90 0">
        <a-entity 
            camera 
            position="0 1.6 0"
            look-controls 
            wasd-controls>
            <a-cursor
                id="cursor"
                raycaster="objects: .ray-target; useWorldCoordinates: true"
                fuse="false"
                geometry="primitive: ring; radiusInner: 0; radiusOuter: 0"
                material="opacity: 0; transparent: true">
            </a-cursor>
        </a-entity>
    </a-entity>


    </a-scene>

    <script>

        const sky = document.getElementById('sky');
        const scene = document.querySelector("a-scene");




        function scene1(){
            sky.setAttribute('material', 'src', './images/check2.jpg');
            
        }
        
        document.getElementById('start_scene1').addEventListener('click',()=>{
            
        document.getElementById('scene1').setAttribute('visible','true')
            document.getElementById('intro_page').style.display='none';
            scene.setAttribute('visible','true');
            if (scene) {
                scene.enterVR();
                scene1();
            }
        });

     //till here
    </script>



    <script>
          const object1_text = document.getElementById('object1_text');
        const object_plane = document.getElementById('object_plane');
        const gazeData = {
            object1: { time: 0 },
        };

        let startTime = null;

        function gaze_calculator_enter() {
            startTime = Date.now();
        }

        function gaze_calculator_exit(dataObj, property, textEl) {
            if (startTime) {
            const duration = Date.now() - startTime;
            dataObj[property] += duration;
            startTime = null;
            textEl.setAttribute('value', `Time: ${(dataObj[property] / 1000).toFixed(3)}s`);
            }
        }

        object_plane.addEventListener('mouseenter', () => {
            gaze_calculator_enter();
        });
        object_plane.addEventListener('mouseleave', () => {
            gaze_calculator_exit(gazeData.object1, 'time', object1_text);
        });

      

    </script>
</body>
</html>